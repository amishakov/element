(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b7e8326"],{"21e6":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"em-file-item-col",on:{click:function(t){return e.openPopup()}}},[e._l(e.localValue,(function(t){return t.noShow?e._e():i("div",{staticClass:"em-file-item-wrapper"},[i("img",{attrs:{src:"image"==t.type?t.sizes.small.path:"/images/fileicon.png",alt:""}})])})),0==e.countFiels?[i("span",{staticClass:"el-empty"},[e._v(e._s(e.$t("empty")))])]:e._e(),e.showPopup?i("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.closePopup,expression:"closePopup"}],staticClass:"em-file__edit"},[e._l(e.localValue,(function(t,a){return t.noShow?e._e():i("div",{staticClass:"em-file__edit-item"},[i("img",{staticClass:"em-file__edit-attach",attrs:{src:"image"==t.type?t.sizes.small.path:"/images/fileicon.png",alt:""}}),i("a",{attrs:{href:"javascript:void(0);"},on:{click:function(t){return e.removeFile(a)}}},[e._v(e._s(e.$t("remove")))])])})),0==e.countFiels?[i("div",{staticClass:"em-file__empty-pop"},[i("span",{staticClass:"el-empty"},[e._v(e._s(e.$t("fieldEmFile.no_files")))])])]:e._e(),i("button",{staticClass:"el-gbtn",on:{click:function(t){return e.openSubPopup()}}},[e._v(e._s(e.$t("fieldEmFile.add_file")))]),e.showSubPopup?i("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.closeSubPopup,expression:"closeSubPopup"}],staticClass:"em-file__upload-popup"},[i("div",{staticClass:"em-file__upload-tab-wrapper"},[i("div",{staticClass:"em-file__upload-tabs-head"},e._l(e.tabs,(function(t){return i("div",{staticClass:"em-file__upload-tab-item",class:{active:t.active},on:{click:function(i){return e.setActiveTab(t)}}},[e._v(e._s(t.name))])})),0),i("div",{staticClass:"em-file__upload-tabs-content-wrapper"},[e.activeTab==e.$t("upload")?i("div",{staticClass:"em-file__file-tab"},[i("input",{ref:"emFile",staticClass:"em-file",attrs:{type:"file",multiple:"true",name:"file",id:"file"},on:{change:function(t){return e.uploadFile("file")}}}),i("label",{staticClass:"el-btn",attrs:{for:"file"}},[e._v(e._s(e.$t("fieldEmFile.choose_file")))])]):e._e(),e.activeTab==e.$t("upload_by_link")?i("div",{staticClass:"em-file__link-tab"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.link,expression:"link"}],staticClass:"el-inp em-file__embed-input",attrs:{type:"text",placeholder:e.$t("paste_link")},domProps:{value:e.link},on:{change:function(t){return e.uploadFile("link")},input:function(t){t.target.composing||(e.link=t.target.value)}}}),i("button",{staticClass:"el-btn"},[e._v(e._s(e.$t("fieldEmFile.embed_link")))])]):e._e()])])]):e._e()],2):e._e()],2)},n=[],l=(i("7f7f"),i("4917"),i("ac4d"),i("8a81"),i("ac6a"),i("b54a"),i("96cf"),i("3b8d")),s={props:["fieldValue","fieldSettings","mode","view"],data:function(){return{localValue:!1,showPopup:!1,showSubPopup:!1,tabs:[{name:this.$t("upload"),active:!0},{name:this.$t("upload_by_link"),active:!1}],activeTab:this.$t("upload"),link:""}},computed:{countFiels:function(){var e=0;if(!this.localValue)return e;for(var t in this.localValue)this.localValue[t].noShow||e++;return e},fieldCode:function(){return"undefined"!==typeof this.fieldSettings.fieldCode&&this.fieldSettings.fieldCode},tableCode:function(){return"undefined"!==typeof this.fieldSettings.tableCode&&this.fieldSettings.tableCode}},methods:{uploadFile:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var i,a,n,l,s,r,o,u,c,p,d,f,h,v;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.localValue||this.$set(this,"localValue",[]),i=new FormData,i.append("tableCode",this.tableCode),i.append("fieldCode",this.fieldCode),"link"!=t){e.next=9;break}i.append("typeUpload","link"),i.append("link",this.link),e.next=35;break;case 9:if("file"!=t){e.next=34;break}if("undefined"!=typeof this.$refs.emFile&&0!=this.$refs.emFile.length){e.next=12;break}return e.abrupt("return");case 12:for(a=!0,n=!1,l=void 0,e.prev=15,s=this.$refs.emFile.files[Symbol.iterator]();!(a=(r=s.next()).done);a=!0)o=r.value,i.append("".concat(this.fieldCode,"[]"),o);e.next=23;break;case 19:e.prev=19,e.t0=e["catch"](15),n=!0,l=e.t0;case 23:e.prev=23,e.prev=24,a||null==s.return||s.return();case 26:if(e.prev=26,!n){e.next=29;break}throw l;case 29:return e.finish(26);case 30:return e.finish(23);case 31:i.append("typeUpload","file"),e.next=35;break;case 34:return e.abrupt("return");case 35:return"table"==this.view&&i.append("prepareForSave",!0),e.next=38,this.$axios({method:"POST",data:i,headers:{"Content-Type":"multipart/form-data"},url:"/field/em_file/index/upload/"});case 38:if(u=e.sent,u.data.success){e.next=41;break}return e.abrupt("return",!1);case 41:for(c=!0,p=!1,d=void 0,e.prev=44,f=u.data.value[Symbol.iterator]();!(c=(h=f.next()).done);c=!0)v=h.value,this.localValue.push(v);e.next=52;break;case 48:e.prev=48,e.t1=e["catch"](44),p=!0,d=e.t1;case 52:e.prev=52,e.prev=53,c||null==f.return||f.return();case 55:if(e.prev=55,!p){e.next=58;break}throw d;case 58:return e.finish(55);case 59:return e.finish(52);case 60:this.sendValue(),this.closeSubPopup();case 62:case"end":return e.stop()}}),e,this,[[15,19,23,31],[24,,26,30],[44,48,52,60],[53,,55,59]])})));function t(t){return e.apply(this,arguments)}return t}(),removeFile:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("undefined"==typeof this.localValue[t].new){e.next=4;break}return this.$delete(this.localValue,t),this.sendValue(),e.abrupt("return");case 4:this.$set(this.localValue[t],"delete",!0),this.$set(this.localValue[t],"noShow",!0),this.sendValue();case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),sendValue:function(e){this.$emit("onChange",{value:this.localValue,settings:this.fieldSettings,tableCode:this.tableCode,fieldCode:this.fieldCode})},setPreviewForImage:function(e,t){null==e.match(/\.(jpeg|jpg|gif|png)$/)&&(e=!1),this.setPreview(e,t)},setPreview:function(e,t){var i=this.localValue[t];i.type=0==e?"no-image":"image",i.sizes={small:{path:e}},this.$set(this.localValue,t,i)},setActiveTab:function(e){var t=!0,i=!1,a=void 0;try{for(var n,l=this.tabs[Symbol.iterator]();!(t=(n=l.next()).done);t=!0){var s=n.value;s.active=!1}}catch(r){i=!0,a=r}finally{try{t||null==l.return||l.return()}finally{if(i)throw a}}e.active=!0,this.activeTab=e.name},openPopup:function(){this.showPopup=!0},openSubPopup:function(){this.showSubPopup=!0},closePopup:function(){this.showPopup=!1,this.closeSubPopup()},closeSubPopup:function(){this.showSubPopup=!1}},watch:{fieldValue:function(e){this.localValue=e}},created:function(){this.localValue=this.fieldValue}},r=s,o=(i("b242"),i("2877")),u=Object(o["a"])(r,a,n,!1,null,null,null);t["default"]=u.exports},2376:function(e,t,i){},4917:function(e,t,i){"use strict";var a=i("cb7c"),n=i("9def"),l=i("0390"),s=i("5f1b");i("214f")("match",1,(function(e,t,i,r){return[function(i){var a=e(this),n=void 0==i?void 0:i[t];return void 0!==n?n.call(i,a):new RegExp(i)[t](String(a))},function(e){var t=r(i,e,this);if(t.done)return t.value;var o=a(e),u=String(this);if(!o.global)return s(o,u);var c=o.unicode;o.lastIndex=0;var p,d=[],f=0;while(null!==(p=s(o,u))){var h=String(p[0]);d[f]=h,""===h&&(o.lastIndex=l(u,n(o.lastIndex),c)),f++}return 0===f?null:d}]}))},b242:function(e,t,i){"use strict";var a=i("2376"),n=i.n(a);n.a}}]);
//# sourceMappingURL=chunk-1b7e8326.e985c3f2.js.map