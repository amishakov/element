(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7a03283e"],{"02bc":function(t,e,n){},"1e0a":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"index__wrapper"},[n("div",{staticClass:"index__head"},[t.table?n("div",{staticClass:"index__head-name"},[n("div",{staticClass:"index__icon-wrapper"},[n("svg",{attrs:{width:"14",height:"13"}},[n("use",{attrs:{"xlink:href":"#tableicon"}})])]),n("div",{staticClass:"index__name-wrapper"},[n("div",{staticClass:"index__overide-name"},[t._v(t._s(t.table.name))]),n("div",{staticClass:"index__real-name"},[t._v(t._s(t.table.code))])])]):t._e(),n("div",{staticClass:"index__head-options"},[n("ul",{staticClass:"index__head-options-list"},[n("li",{staticClass:"index__menu-item",class:{active:t.popups.isPropertiesPopupShow},on:{click:function(e){return t.openPopup("isPropertiesPopupShow")}}},[t._v("\n\t\t\t\t\t"+t._s(t.$t("properties"))+"\n\t\t\t\t\t"),t.popups.isPropertiesPopupShow&&t.propertiesPopupData?n("Properties",{directives:[{name:"click-outside",rawName:"v-click-outside:isPropertiesPopupShow",value:t.closePopup,expression:"closePopup",arg:"isPropertiesPopupShow"}],attrs:{columns:t.propertiesPopupData}}):t._e()],1),n("li",{staticClass:"index__menu-item",class:{active:t.popups.isSortPopupShow},on:{click:function(e){return t.openPopup("isSortPopupShow")}}},[t._v("\n\t\t\t\t\t"+t._s(t.$t("sort"))+"\n\t\t\t\t\t"),t.popups.isSortPopupShow?n("SortPopup",{directives:[{name:"click-outside",rawName:"v-click-outside:isSortPopupShow",value:t.closePopup,expression:"closePopup",arg:"isSortPopupShow"}],attrs:{columns:t.table.columns,tview:t.activeTview}}):t._e()],1),n("li",{staticClass:"index__menu-item",class:{active:t.popups.isFiltersPopupShow},on:{click:function(e){return t.openPopup("isFiltersPopupShow")}}},[t._v("\n\t\t\t\t\t"+t._s(t.$t("filter"))+"\n\t\t\t\t\t"),t.popups.isFiltersPopupShow?n("FiltersPopup",{directives:[{name:"click-outside",rawName:"v-click-outside:isFiltersPopupShow",value:t.closePopup,expression:"closePopup",arg:"isFiltersPopupShow"}],attrs:{columns:t.table.columns,tview:t.activeTview}}):t._e()],1),n("li",{staticClass:"index__menu-item index__menu-item-more",class:{active:t.popups.isExportPopupShow},on:{click:function(e){return t.openPopup("isExportPopupShow")}}},[t._v("\n\t\t\t\t\t...\n\t\t\t\t\t"),t.popups.isExportPopupShow?n("ExportPopup",{directives:[{name:"click-outside",rawName:"v-click-outside:isExportPopupShow",value:t.closePopup,expression:"closePopup",arg:"isExportPopupShow"}],attrs:{tview:t.activeTview}}):t._e()],1)]),n("button",{staticClass:"index__add-btn el-btn",on:{click:function(e){return t.addElement()}}},[n("svg",{attrs:{width:"12",height:"12"}},[n("use",{attrs:{"xlink:href":"#plus"}})]),t._v("\n\t\t\t\t"+t._s(t.$t("add_element"))+"\n\t\t\t")])])]),t.table&&t.activeTview?n("Table",{attrs:{table:t.table,tview:t.activeTview}}):t._e()],1)},r=[],s=(n("ac6a"),n("ac4d"),n("8a81"),n("5df3"),n("1c4c"),n("6b54"),n("7f7f"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"filters-popup__wrapper"},[n("div",{staticClass:"filters-popup__rows"},t._l(t.filter,(function(e,i){return n("div",{staticClass:"filters-popup__row"},[n("div",{staticClass:"filters-popup__operators-wrapper"},[i>0?n("Select",{staticClass:"filters-popup__select",attrs:{defaultText:t.defaultOper}},t._l(t.binOperations,(function(e){return n("SelectOption",{key:e,class:{active:t.defaultOper==e},nativeOn:{click:function(n){return t.selectLogic(e)}}},[t._v(t._s(e))])})),1):t._e(),n("Select",{staticClass:"filters-popup__select",attrs:{defaultText:e.name?e.name:e.code}},t._l(t.columns,(function(i){return n("SelectOption",{key:i.field,class:{active:e.code==i.field},nativeOn:{click:function(n){return t.selectColumn(e,i)}}},[t._v(t._s(i.em.name?i.em.name:i.field))])})),1),n("Select",{staticClass:"filters-popup__select",attrs:{defaultText:t.getColumnCollationName(e.code,e.operation)}},t._l(t.getColumnCollations(e.code),(function(i){return n("SelectOption",{key:i.code,class:{active:e.operation==i.code},nativeOn:{click:function(n){return t.selectOperation(e,i)}}},[t._v(t._s(i.name))])})),1),n("MainFilterField",{attrs:{filter:e,columns:t.columns},on:{onChange:t.changeFilterValue}})],1),n("div",{staticClass:"filters-popup__delete-row-icon-wrapper",on:{click:function(e){return e.stopPropagation(),t.deleteRowFilter(i)}}},[n("div",{staticClass:"filters-popup__delete-row-icon"},[n("svg",{attrs:{width:"12",height:"12"}},[n("use",{attrs:{"xlink:href":"#plus-white"}})])])])])})),0),n("button",{staticClass:"el-gbtn",on:{click:t.addFilterRow}},[t._v(t._s(t.$t("popups.filtersPopup.add_filter")))])])}),o=[],a=(n("55dd"),n("96cf"),n("3b8d")),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(t.filterComponent,{tag:"component",attrs:{filter:t.filter,settings:t.settings},on:{onChange:t.changeValue}})},u=[],c={props:["filter","columns"],data:function(){return{settings:!1}},computed:{filterComponent:function(){var t=this.columns[this.filter.code];if("undefined"==typeof t.em)return!1;var e=t.em.type_info.code;return this.settings=t.em.settings,function(){return n("91b9")("./".concat(e,"/Filter.vue"))}}},methods:{changeValue:function(t){this.$emit("onChange",{value:t,filter:this.filter})}}},p=c,d=n("2877"),f=Object(d["a"])(p,l,u,!1,null,null,null),m=f.exports,h=n("d230");function v(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=w(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function w(t,e){if(t){if("string"===typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(t,e):void 0}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var b={components:{MainFilterField:m},props:["columns","tview"],data:function(){return{select:{columnSelect:!1,operationSelect:!1,binSelect:!1},operations:[],binOperations:["AND","OR"],defaultOper:"AND",filter:[],newFilters:[],sourceFilters:[],sendRequest:!0}},watch:{filter:{handler:function(){this.newFilters=[],this.buildNewFilter(this.newFilters,JSON.parse(JSON.stringify(this.filter))),this.tview.filter=0==this.newFilters[0].fields.length?[]:this.newFilters[0];var t=this;if(!this.sendRequest)return!1;this.saveFilters(),this.sendRequest=!1,setTimeout((function(){t.sendRequest=!0,t.saveFilters()}),2e3)},deep:!0}},methods:{selectColumn:function(t,e){t.code=e.field,t.name=e.em.name,this.operations=e.em.collations},selectOperation:function(t,e){t.operation=e.code},selectLogic:function(t){this.defaultOper=t},saveFilters:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,i,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this,i=n("4328"),r=i.stringify({filters:0==this.newFilters[0].fields.length?[]:this.newFilters[0],tviewId:this.tview.id}),t.next=5,this.$store.dispatch("select",{select:{from:e.tview.table,page:1,tview:e.tview.id,where:0==this.newFilters[0].fields.length?"":e.newFilters[0],order:e.tview.sort}});case 5:return t.next=7,this.$axios({method:"GET",url:"/tview/saveFilters/",params:r,paramsSerializer:function(t){return r}});case 7:if(s=t.sent,s.data.success){t.next=10;break}return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),buildNewFilter:function(t,e){if("undefined"==typeof e)return!1;t.push({operation:this.defaultOper,fields:[]});var n,i=v(e);try{for(i.s();!(n=i.n()).done;){var r=n.value;t[0].fields.push({code:r.code,operation:r.operation,value:r.value})}}catch(s){i.e(s)}finally{i.f()}},getFirstElement:function(t){for(var e in t)return t[e]},addFilterRow:function(){var t=this.getFirstElement(this.columns);this.filter.push({code:t.field,operation:t.em.collations[0].code,name:t.em.name,value:"",select:JSON.parse(JSON.stringify(this.select))})},deleteRowFilter:function(t){this.filter.splice(t,1)},getColumnNameByCode:function(t){return"undefined"!=typeof this.columns[t]&&"undefined"!=typeof this.columns[t].em.name?this.columns[t].em.name:t},getColumnCollations:function(t){return"undefined"!=typeof this.columns[t]&&"undefined"!=typeof this.columns[t].em.collations?this.columns[t].em.collations:[]},getColumnCollationName:function(t,e){if("undefined"==typeof this.columns[t]||"undefined"==typeof this.columns[t].em.collations)throw new Error("No collation with code ".concat(t));var n,i=this.columns[t].em.collations,r=v(i);try{for(r.s();!(n=r.n()).done;){var s=n.value;if(s.code==e)return s.name}}catch(o){r.e(o)}finally{r.f()}},parseFilers:function(t,e){if("undefined"!=typeof t.fields)return this.defaultOper=t.operation,this.parseFilers(t.fields,t.operation),!1;for(var n in t)"undefined"==typeof t[n].fields?(this.$set(t[n],"select",JSON.parse(JSON.stringify(this.select))),this.$set(t[n],"name",this.getColumnNameByCode(t[n].code)),this.filter.push(JSON.parse(JSON.stringify(t[n])))):this.parseFilers(t[n].fields,t[n].operation)},changeFilterValue:function(t){t.filter.value=t.value}},mounted:function(){this.parseFilers(this.tview.filter),this.sourceFilters=this.tview.filter}},y=b,S=(n("5040"),Object(d["a"])(y,s,o,!1,null,null,null)),g=S.exports,C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"export-popup-wr"},[n("div",{staticClass:"export-popup"},[n("a",{staticClass:"export-popup-btn",attrs:{target:"blank",href:t.linkToDownloadCsv}},[t._v("\n\t\t\tExport to CSV\n\t\t")])])])},P=[],x={props:["tview"],computed:{linkToDownloadCsv:function(){return"/element/api/tview/exportCsv?tviewId="+this.tview.id}}},k=x,F=(n("26da"),Object(d["a"])(k,C,P,!1,null,null,null)),O=F.exports,$=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"sort-popup__wrapper"},[n("div",{staticClass:"sort-popup__rows"},t._l(t.sortArray,(function(e,i){return n("div",{staticClass:"sort-popup__row"},[n("div",{staticClass:"sort-popup__operators-wrapper"},[n("Select",{staticClass:"sort-popup__select",attrs:{defaultText:e.selectedColumn.name?e.selectedColumn.name:e.selectedColumn.code}},t._l(t.columns,(function(i){return n("SelectOption",{key:i.field,class:{active:i.field==e.selectedColumn.code},attrs:{value:i.field},nativeOn:{click:function(n){return t.selectCol(e,i)}}},[t._v(t._s(i.em.name?i.em.name:i.field))])})),1),n("Select",{staticClass:"sort-popup__select",attrs:{defaultText:e.default}},t._l(t.sortValues,(function(i,r){return n("SelectOption",{key:r,class:{active:e.default==i},nativeOn:{click:function(n){return t.selectSorting(e,r,i)}}},[t._v(t._s(i))])})),1)],1),n("div",{staticClass:"sort-popup__delete-row-icon-wrapper",on:{click:function(e){return e.stopPropagation(),t.deleteRowSort(i)}}},[n("div",{staticClass:"sort-popup__delete-row-icon"},[n("svg",{attrs:{width:"12",height:"12"}},[n("use",{attrs:{"xlink:href":"#plus-white"}})])])])])})),0),n("button",{staticClass:"el-gbtn",on:{click:t.addSortRow}},[t._v(t._s(t.$t("popups.sortPopup.add_sort")))])])},A=[];n("28a5");function E(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=N(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function N(t,e){if(t){if("string"===typeof t)return T(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(t,e):void 0}}function T(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var R={props:["tview","columns"],data:function(){return{sortParams:"",sortArray:[],sortValues:{ASC:"Ascenging",DESC:"Descending"},finalSort:[],sendRequest:!0}},watch:{sortArray:{handler:function(){if(!this.sendRequest)return!1;var t=this;this.buildSortParams(),t.sendRequest=!1,setTimeout((function(){t.sendRequest=!0,t.buildSortParams()}),2e3)},deep:!0}},methods:{selectCol:function(t,e){t.selectedColumn.code=e.field,t.selectedColumn.name=e.em.name},selectSorting:function(t,e,n){t.selectedSort=e,t.default=n},buildSortParams:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,i,r,s,o,a,l,u,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=[],i=E(this.sortArray);try{for(i.s();!(r=i.n()).done;)s=r.value,o=[],o.push(s.selectedColumn.code),o.push(s.selectedSort),e.push(o.join(" "))}catch(p){i.e(p)}finally{i.f()}return this.finalStrSort=e,this.sortParams=e,this.tview.sort=e,a=this,l=n("4328"),u=l.stringify({sort:e,tviewId:this.tview.id}),t.next=11,this.$store.dispatch("select",{select:{from:a.tview.table,page:1,tview:a.tview.id,where:"undefined"==typeof a.tview.filter.fields?"":a.tview.filter,order:e}});case 11:return t.next=13,this.$axios({method:"GET",url:"/tview/saveSort/",params:u,paramsSerializer:function(t){return u}});case 13:if(c=t.sent,c.data.success){t.next=16;break}return t.abrupt("return",!1);case 16:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getFirstElement:function(t){for(var e in t)return t[e]},addSortRow:function(){var t={},e=this.getFirstElement(this.columns);this.$set(t,"default","Ascenging"),this.$set(t,"selectedSort","ASC"),this.$set(t,"selectedColumn",{code:e.field,name:e.em.name}),this.$set(t,"popups",{isOpenSelectColumn:!1,isOpenSelectSort:!1}),this.sortArray.push(t)},deleteRowSort:function(t){this.sortArray.splice(t,1)},getColumnNameByCode:function(t,e){for(var n in t)if(t[n].field==e)return t[n].em.name;return e},parseSortParam:function(){var t,e=this.tview.sort,n=E(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=i.trim().split(" ")[0],s=i.trim().split(" ")[1],o={};this.$set(o,"default",this.sortValues[s]),this.$set(o,"selectedSort",s),this.$set(o,"selectedColumn",{code:r,name:this.getColumnNameByCode(this.columns,r)}),this.$set(o,"popups",{isOpenSelectColumn:!1,isOpenSelectSort:!1}),this.sortArray.push(o)}}catch(a){n.e(a)}finally{n.f()}}},mounted:function(){this.sortParams=this.tview.sort,this.parseSortParam()}},j=R,I=(n("588e"),Object(d["a"])(j,$,A,!1,null,null,null)),D=I.exports,J=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"properties-popup"},[n("div",{staticClass:"properties-list"},t._l(t.columns,(function(t){return n("PropertyItem",{key:t.field,attrs:{column:t}})})),1)])},q=[],V=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"property-item-list-item",on:{click:function(t){t.stopPropagation()}}},[i("div",[i("div",{staticClass:"property-item-big-icon"},[i("img",{attrs:{src:n("53a4")("./assets"+t.column.em.type_info.iconPath),alt:""}})])]),i("div",{staticClass:"property-item-names-wrapper"},[i("div",{staticClass:"property-item-overide-name"},[t._v(t._s(t.getColName(t.column)))]),i("div",{staticClass:"property-item-real-name"},[t._v(t._s(t.column.field))])]),i("div",{staticClass:"property-item-checkbox-wrapper"},[i("Checkbox",{attrs:{checked:t.column.visible},on:{"update:checked":function(e){return t.$set(t.column,"visible",e)}}})],1)])},M=[],U={props:["column"],methods:{getColName:function(t){return"undefined"!=typeof t.em&&t.em.name?t.em.name:t.field}}},B=U,L=(n("6412"),Object(d["a"])(B,V,M,!1,null,null,null)),z=L.exports,G={props:["columns"],components:{PropertyItem:z}},H=G,K=(n("a805"),Object(d["a"])(H,J,q,!1,null,null,null)),Q=K.exports;function W(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=X(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function X(t,e){if(t){if("string"===typeof t)return Y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Y(t,e):void 0}}function Y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var Z={mixins:[h["a"]],components:{Properties:Q,FiltersPopup:g,ExportPopup:O,SortPopup:D},metaInfo:function(){var t=this.table?this.table.name:"";return{title:"Table: ".concat(t)}},data:function(){return{table:!1,popups:{isPropertiesPopupShow:!1,isFiltersPopupShow:!1,isSortPopupShow:!1,isExportPopupShow:!1},propertiesPopupData:{}}},computed:{activeTview:function(){var t,e=this.$route.params.tview,n=W(this.table.tviews);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.id==e)return i}}catch(r){n.e(r)}finally{n.f()}}},methods:{openPopup:function(t){this.popups[t]=!0},closePopup:function(t,e){this.popups[e]=!1},activeTable:function(){this.table=this.$store.getters.getTable(this.$route.params.tableCode),this.propertiesPopupData=this.table.columns},addElement:function(){this.$router.push("/table/".concat(this.table.code,"/add/"))}},mounted:function(){this.activeTable()},watch:{"$route.fullPath":function(){this.activeTable()}}},tt=Z,et=(n("ddc5"),Object(d["a"])(tt,i,r,!1,null,null,null));e["default"]=et.exports},"1e7e":function(t,e,n){},"26da":function(t,e,n){"use strict";n("b583")},"27bc":function(t,e,n){},4020:function(t,e,n){},5040:function(t,e,n){"use strict";n("02bc")},"588e":function(t,e,n){"use strict";n("1e7e")},6412:function(t,e,n){"use strict";n("27bc")},"91b9":function(t,e,n){var i={"./em_check/Filter.vue":["7686","chunk-2d0d7313"],"./em_date/Filter.vue":["769c","chunk-10b10894"],"./em_file/Filter.vue":["aa98","chunk-2d212c35"],"./em_int/Filter.vue":["196e","chunk-2d0ac40d"],"./em_list/Filter.vue":["7c85","chunk-cf0d4de0"],"./em_node/Filter.vue":["2ad4","chunk-710a847d"],"./em_primary/Filter.vue":["c330","chunk-2d216783"],"./em_string/Filter.vue":["9171","chunk-2d0e48e8"],"./em_text/Filter.vue":["6edd","chunk-2d0db4a5"]};function r(t){if(!n.o(i,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=i[t],r=e[0];return n.e(e[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(i)},r.id="91b9",t.exports=r},a805:function(t,e,n){"use strict";n("dd8b")},b583:function(t,e,n){},dd8b:function(t,e,n){},ddc5:function(t,e,n){"use strict";n("4020")}}]);
//# sourceMappingURL=chunk-7a03283e.7f142d81.js.map