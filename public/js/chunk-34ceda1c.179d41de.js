(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-34ceda1c"],{1006:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"em-matrix"},["detail"==e.view?a("div",{staticClass:"em-matrix-table"},[e.fieldValue.matrixValue.length?a("table",[a("tr",[e._l(e.tableHead,(function(t){return a("th",[e._v(e._s(t))])})),a("th")],2),e._l(e.fieldValue.matrixValue,(function(t,n){return a("tr",[e._l(t,(function(t){return a("td",[e._v(e._s(t))])})),a("td",{staticClass:"em-matrix-table__edit-btns"},[a("div",{staticClass:"em-matrix-field__hover-btns"},[a("div",{staticClass:"em-matrix-field em-matrix-field__edit",on:{click:function(a){return e.popupForEditMatrixColumn(t,n)}}},[e._v("\n\t\t\t\t\t\t\t"+e._s(e.$t("edit"))+"\n\t\t\t\t\t\t")]),a("div",{staticClass:"em-matrix-field em-matrix-field__remove",on:{click:function(a){return e.removeMatrixElement({tableCode:e.fieldSettings.finalTableCode,selectedElement:t})}}},[e._v("\n\t\t\t\t\t\t\t"+e._s(e.$t("remove"))+"\n\t\t\t\t\t\t")])])])],2)}))],2):e._e(),a("div",{staticClass:"em-matrix-row-add",on:{click:function(t){return e.popupForCreateMatrixElement()}}},[a("div",{staticClass:"em-matrix-row-add__icon"},[a("svg",{attrs:{width:"9",height:"9"}},[a("use",{attrs:{"xlink:href":"#plus-gray"}})])]),a("div",{staticClass:"em-matrix-row-add__text"},[e._v(" New ")])])]):a("div",[a("span",{staticClass:"el-empty"},[e._v("Matrix field")])]),a("DetailPopup",{attrs:{visible:e.showDetail,tableCode:e.detailTableCode,name:e.detailName,id:e.detailTableId,element:e.currentElement},on:{"update:visible":function(t){e.showDetail=t},saveElement:e.savePopupMatrixElement,createElement:e.createPopupMatrixElement,removeElement:e.removePopupMatrixElement}})],1)},i=[],s=(a("ac4d"),a("8a81"),a("5df3"),a("1c4c"),a("7f7f"),a("6b54"),a("768b")),l=(a("ac6a"),a("a13b")),r=a("2520");function c(e,t){var a="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=o(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,l=!0,r=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return l=e.done,e},e:function(e){r=!0,s=e},f:function(){try{l||null==a.return||a.return()}finally{if(r)throw s}}}}function o(e,t){if(e){if("string"===typeof e)return u(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var d={props:["fieldValue","fieldSettings","mode","view"],components:{DetailPopup:r["a"]},mixins:[l["a"]],data:function(){return{showDetail:!1,detailTableCode:!1,detailTableId:!1,detailName:!1,currentElement:!1}},computed:{tableHead:function(){if("undefined"==typeof this.fieldValue.matrixValue||!this.fieldValue.matrixValue.length)return[];var e=[];for(var t in this.fieldValue.matrixValue[0])e.push(t);return e},detailElement:function(){return this.$store.state.tables.selectedElement}},methods:{updateMatrixTableElement:function(e){var t,a=this.$store.getters.getPrimaryKeyCode(this.fieldSettings.finalTableCode),n=c(this.fieldValue.matrixValue.entries());try{for(n.s();!(t=n.n()).done;){var i=Object(s["a"])(t.value,2),l=i[0],r=i[1];if(+r[a]==+e[a])return this.fieldValue.matrixValue[l]=e}}catch(o){n.e(o)}finally{n.f()}},createMatrixTableElement:function(e){"undefined"==typeof this.fieldValue.matrixValue&&this.$set(this.fieldValue,"matrixValue",[]);this.$store.getters.getPrimaryKeyCode(this.fieldSettings.finalTableCode);this.fieldValue.matrixValue.push(e)},removeMatrixTableElement:function(e){var t,a=this.$store.getters.getPrimaryKeyCode(this.fieldSettings.finalTableCode),n=c(this.fieldValue.matrixValue.entries());try{for(n.s();!(t=n.n()).done;){var i=Object(s["a"])(t.value,2),l=i[0],r=i[1];if(+r[a]==+e[a])return this.fieldValue.matrixValue.splice(l,1)}}catch(o){n.e(o)}finally{n.f()}},popupForEditMatrixColumn:function(e,t){this.currentElement=!1;var a=this.$store.getters.getPrimaryKeyCode(this.fieldSettings.finalTableCode);this.detailTableId=e[a],this.detailTableCode=this.fieldSettings.finalTableCode,this.detailName=!1,this.showDetail=!0},bindDefaultColumnValues:function(){this.currentElement=[];var e=this.$store.getters.getTable(this.fieldSettings.finalTableCode);for(var t in e.columns)this.currentElement[t]="";this.currentElement[this.fieldSettings.finalTableField]=this.detailElement[this.fieldSettings.localField]},popupForCreateMatrixElement:function(){this.bindDefaultColumnValues(),this.detailTableCode=this.fieldSettings.finalTableCode,this.detailName="tableAddElement",this.showDetail=!0},savePopupMatrixElement:function(e,t){t.data.success&&(this.updateMatrixTableElement(e.selectedElement),this.ElMessage(this.$t("elMessages.element_saved")),this.showDetail=!1)},createPopupMatrixElement:function(e,t){if(1==t.data.success){var a=this.$store.getters.getPrimaryKeyCode(this.fieldSettings.finalTableCode);e.selectedElement[a]=t.data.lastid,this.createMatrixTableElement(e.selectedElement),this.ElMessage(this.$t("elMessages.element_created")),this.showDetail=!1}else this.ElMessage.error(this.$t("elMessages.cant_create_element"))},removeMatrixElement:function(e){this.removeElement(e),this.showDetail=!1,this.ElMessage(this.$t("elMessages.element_removed")),this.removeMatrixTableElement(e.selectedElement)},removePopupMatrixElement:function(e,t){this.showDetail=!1,this.ElMessage(this.$t("elMessages.element_removed")),this.removeMatrixTableElement(e.selectedElement)}}},m=d,h=(a("6d7a"),a("2877")),f=Object(h["a"])(m,n,i,!1,null,null,null);t["default"]=f.exports},"16cd":function(e,t,a){"use strict";a("e7ba")},2520:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"detail-popup"},[a("Popup",{attrs:{visible:e.isPopupVisible},on:{"update:visible":function(t){e.isPopupVisible=t}}},[a("Detail",{attrs:{tableCode:e.tableCode,name:e.name,id:e.id,element:e.element,updatedElAt:e.updatedElAt},on:{"update:updatedElAt":function(t){e.updatedElAt=t},"update:updated-el-at":function(t){e.updatedElAt=t},cancel:e.cancel,openDetail:e.openDetail,saveElement:e.saveDetailElement,removeElement:e.removeDetailElement,createElement:e.createDetailElement}})],1)],1)},i=[],s=(a("96cf"),a("3b8d")),l=a("b97e"),r=a("a13b"),c={props:["tableCode","name","id","visible","element"],components:{Detail:l["a"]},mixins:[r["a"]],data:function(){return{updatedElAt:new Date}},computed:{isPopupVisible:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},methods:{cancel:function(){this.isPopupVisible=!1},openDetail:function(e){this.$emit("openDetail",e)},saveDetailElement:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.saveElement(t);case 2:if(a=e.sent,a.data.success){e.next=5;break}return e.abrupt("return",this.ElMessage(a.data.message));case 5:this.$emit.apply(this,["saveElement"].concat([t,a])),this.updatedElAt=new Date;case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),createDetailElement:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.createElement(t);case 2:if(a=e.sent,a.data.success){e.next=5;break}return e.abrupt("return",this.ElMessage(a.data.message));case 5:this.$emit.apply(this,["createElement"].concat([t,a]));case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),removeDetailElement:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.removeElement(t);case 2:if(a=e.sent,a.data.success){e.next=5;break}return e.abrupt("return",this.ElMessage(a.data.message));case 5:this.$emit.apply(this,["removeElement"].concat([t,a]));case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},o=c,u=(a("16cd"),a("2877")),d=Object(u["a"])(o,n,i,!1,null,null,null);t["a"]=d.exports},4988:function(e,t,a){},"6d7a":function(e,t,a){"use strict";a("8975")},"851c":function(e,t,a){"use strict";a("4988")},8975:function(e,t,a){},a13b:function(e,t,a){"use strict";a("ac6a"),a("96cf");var n=a("3b8d"),i=a("4328"),s=a.n(i);t["a"]={methods:{saveElement:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("saveSelectedElement",t);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),createElement:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a,n,i,l,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=this.$store.getters.getPrimaryKeyCode(t.tableCode),n={},e.t0=regeneratorRuntime.keys(t.selectedElement);case 3:if((e.t1=e.t0()).done){e.next=10;break}if(i=e.t1.value,a!=i){e.next=7;break}return e.abrupt("continue",3);case 7:n[i]=t.selectedElement[i],e.next=3;break;case 10:return l=s.a.stringify({insert:{table:t.tableCode,values:[n]}}),e.next=13,this.$axios.post("/el/insert/",l);case 13:return r=e.sent,e.abrupt("return",r);case 15:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),removeElement:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=this.$store.getters.getPrimaryKeyCode(t.tableCode),e.next=3,this.$store.dispatch("removeRecord",{delete:{table:t.tableCode,where:{operation:"and",fields:[{code:a,operation:"IS",value:t.selectedElement[a]}]}}});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}}},b97e:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"detail"},[n("div",{staticClass:"detail-head"},[n("div",{staticClass:"detail-head__burger",class:{hidden:e.isShowSidebar}},[n("MobileBurger")],1),n("div",{staticClass:"detail-head-name"},[n("div",{staticClass:"detail-icon-wrapper"},[n("svg",{attrs:{width:"14",height:"13"}},[n("use",{attrs:{"xlink:href":"#tableicon"}})])]),"tableAddElement"!=e.name?[n("div",{staticClass:"detail-name-wrapper"},[n("div",{staticClass:"detail-head-label"},[e._v(e._s(e.$t("pages.table.edit_element")))]),n("div",{staticClass:"detail-head-descr"},[e._v(e._s(e.tableCode))])]),n("div",{staticClass:"detail-head__buttons"},[n("button",{staticClass:"el-gbtn",on:{click:e.cancel}},[e._v(e._s(e.$t("cancel")))]),n("button",{staticClass:"el-gbtn",on:{click:e.remove}},[e._v(e._s(e.$t("remove")))]),n("button",{staticClass:"el-btn",on:{click:e.saveElement}},[e._v(e._s(e.$t("save")))])])]:[n("div",{staticClass:"detail-name-wrapper"},[n("div",{staticClass:"detail-head-label"},[e._v(e._s(e.$t("pages.table.new_element")))]),n("div",{staticClass:"detail-head-descr"},[e._v(e._s(e.tableCode))])]),n("div",{staticClass:"detail-head__buttons"},[n("button",{staticClass:"el-gbtn",on:{click:e.cancel}},[e._v(e._s(e.$t("cancel")))]),n("button",{staticClass:"el-btn",on:{click:e.createElement}},[e._v(e._s(e.$t("create")))])])]],2)]),n("div",{staticClass:"detail-feilds"},e._l(e.selectedElement,(function(t,i){return n("div",{key:"selItem"+i,staticClass:"detail-feild"},[n("div",{staticClass:"detail-field__name-wrap"},[n("img",{staticClass:"detail-field__icon-image",attrs:{src:a("53a4")("./assets"+e.columnEmSettings(i).type_info.iconPath)}}),n("div",{staticClass:"detail-field-name"},[n("span",[e._v(e._s(e.getColumnName(i)))]),n("small",[e._v(e._s(i))])])]),n("div",{staticClass:"detail-field-box"},[e.columns[i]?n("MainField",{attrs:{mode:"edit",view:"detail",fieldName:e.columns[i].em.settings.code,params:{value:t,settings:e.$store.getters.getColumnSettings(e.tableCode,i,e.selectedElement)}},on:{onChange:e.changeFieldValue}}):e._e()],1)])})),0),n("div",{staticClass:"detail__buttons"},["tableAddElement"!=e.name?[n("button",{staticClass:"el-gbtn",on:{click:e.cancel}},[e._v(e._s(e.$t("cancel")))]),n("button",{staticClass:"el-gbtn",on:{click:e.remove}},[e._v(e._s(e.$t("remove")))]),n("button",{staticClass:"el-btn",on:{click:e.saveElement}},[e._v(e._s(e.$t("save")))])]:[n("button",{staticClass:"el-gbtn",on:{click:e.cancel}},[e._v(e._s(e.$t("cancel")))]),n("button",{staticClass:"el-btn",on:{click:e.createElement}},[e._v(e._s(e.$t("create")))])]],2)])},i=[],s=(a("8e6e"),a("ac6a"),a("456d"),a("7f7f"),a("96cf"),a("3b8d")),l=a("bd86"),r=a("6e3e"),c=(a("4328"),a("25bd")),o=a("2f62");function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){Object(l["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var m={props:["tableCode","name","id","element","updatedElAt"],components:{MainField:r["a"],MobileBurger:c["a"]},computed:d({},Object(o["b"])(["isShowSidebar"])),data:function(){return{columns:{},selectedElement:{},fieldNames:{}}},watch:{id:function(e){this.selectedElement.id=e},updatedElAt:function(e){this.selectElement()}},mounted:function(){this.selectElement(),this.fieldNames=Object.assign(this.fieldNames,this.$store.getters.getTableFieldsNames(this.tableCode))},methods:{selectElement:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t={select:{},where:[],order:[]},t.select.from=this.tableCode,a=this.$store.getters.getPrimaryKeyCode(this.tableCode),this.columns=this.$store.getters.getColumns(this.tableCode),"tableAddElement"==this.name||this.element){e.next=11;break}return t.select.where={operation:"and",fields:[{code:a,operation:"IS",value:this.id}]},e.next=8,this.$store.dispatch("selectElement",t);case 8:this.$set(this,"selectedElement",this.$store.state.tables.selectedElement),e.next=12;break;case 11:for(n in this.columns)this.$set(this.selectedElement,n,""),this.$set(this.selectedElement,n,""),this.element&&"undefined"!=typeof this.element[n]&&this.$set(this.selectedElement,n,this.element[n]);case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),changeFieldValue:function(e){this.selectedElement[e.settings.fieldCode]=e.value},columnEmSettings:function(e){if("undefined"!=typeof this.columns[e])return this.columns[e].em;throw new Error("No column with code ".concat(e))},getColumnName:function(e){return this.columnEmSettings(e).name||e},saveElement:function(){this.$emit("saveElement",{selectedElement:this.selectedElement,tableCode:this.tableCode})},createElement:function(){this.$emit("createElement",{selectedElement:this.selectedElement,tableCode:this.tableCode})},cancel:function(){this.$emit("cancel")},remove:function(){this.$emit("removeElement",{selectedElement:this.selectedElement,tableCode:this.tableCode})}}},h=m,f=(a("851c"),a("2877")),p=Object(f["a"])(h,n,i,!1,null,null,null);t["a"]=p.exports},e7ba:function(e,t,a){}}]);
//# sourceMappingURL=chunk-34ceda1c.179d41de.js.map